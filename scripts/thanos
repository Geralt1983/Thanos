#!/bin/bash
#
# Thanos CLI - Personal AI Assistant
# Wrapper script for thanos.py CLI entry point
#

set -e

# Project root (relative to this script)
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(dirname "$SCRIPT_DIR")"

# Virtual environment
VENV_PATH="$PROJECT_ROOT/.venv"
PYTHON="$VENV_PATH/bin/python"

# Check venv exists
if [ ! -f "$PYTHON" ]; then
    echo "Error: Virtual environment not found at $VENV_PATH"
    echo "Run: python3 -m venv $VENV_PATH && $VENV_PATH/bin/pip install anthropic"
    exit 1
fi

# Load environment variables from .env
ENV_FILE="$PROJECT_ROOT/.env"
if [ -f "$ENV_FILE" ]; then
    set -a
    source "$ENV_FILE"
    set +a
fi

# Set PYTHONPATH so imports work
export PYTHONPATH="$PROJECT_ROOT:$PYTHONPATH"

# Call thanos.py with all arguments passed through
# thanos.py handles all command routing, shortcuts, and natural language
exec "$PYTHON" "$PROJECT_ROOT/thanos.py" "$@"
